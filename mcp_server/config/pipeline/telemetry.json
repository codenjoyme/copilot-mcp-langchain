{
  "pipeline": [
    {
      "tool": "lng_javascript_execute",
      "params": {
        "function_name": "telemetry/setOrderMap"
      },
      "output": "order_map"
    },
    {
      "tool": "lng_file_list",
      "params": {
        "directory_path": "work/telemetry/in",
        "include_directories": false,
        "include_files": true,
        "pattern": "*.json",
        "path_type": "absolute",
        "output_format": "json"
      },
      "output": "telemetry_files",
      "output_log": "file_list_debug"
    },
    {
      "type": "forEach",
      "forEach": "{! telemetry_files.items !}",
      "item": "current_file",
      "output": "file_content",
      "item_output": "{! file_data !}",
      "do": [
        {
          "tool": "lng_file_read",
          "params": {
            "file_path": "{! current_file.absolute_path !}",
            "output_format": "plain_text"
          },
          "output": "file_data"
        }
      ]
    },
    {
      "tool": "lng_javascript_execute",
      "params": {
        "function_name": "telemetry/mergeJsons",
        "parameters": {
          "json_arrays": "{! file_content !}"
        }
      },
      "output": "merged_data",
      "output_log": "after_merge"
    },
    {
      "tool": "lng_javascript_execute",
      "params": {
        "function_name": "telemetry/appendFieldsDescription",
        "parameters": {
          "data": "{! merged_data !}"
        }
      },
      "output": "data_with_descriptions",
      "output_log": "with_descriptions"
    },
    {
      "tool": "lng_javascript_execute",
      "params": {
        "function_name": "telemetry/prettyPrintAndSort",
        "parameters": {
          "data": "{! data_with_descriptions !}",
          "orderMap": "{! order_map !}"
        }
      },
      "output": "sorted_data",
      "output_log": "pretty_printed"
    },
    {
      "tool": "lng_json_to_csv",
      "params": {
        "json_data": "{! sorted_data !}",
        "format": "csv"
      },
      "output": "csv_content",
      "output_log": "final_csv"
    },
    {
      "tool": "lng_file_write",
      "params": {
        "file_path": "work/telemetry/out/telemetry.csv",
        "content": "{! csv_content !}",
        "mode": "overwrite"
      },
      "output": "csv_file_saved"
    },
    {
      "tool": "lng_xls_batch",
      "params": {
        "workspace": {
          "csv_source": "work/telemetry/out/telemetry.csv",
          "template": "work/telemetry/in/telemetry.xlsx"
        },
        "analyze": true,
        "operations": []
      },
      "output": "file_analysis"
    },
    {
      "tool": "lng_xls_batch",
      "params": {
        "workspace": {
          "csv_source": "work/telemetry/out/telemetry.csv",
          "template": "work/telemetry/in/telemetry.xlsx",
          "result": "work/telemetry/out/telemetry.xlsx"
        },
        "operations": [
          {
            "from": "[csv_source]A7:AP[! file_analysis['analysis']['csv_source']['sheets']['Sheet1']['max_row'] !]",
            "to": "[template]Sheet1!A11",
            "save_as": "result",
            "copy": ["values"],
            "insert": "replace"
          }
        ]
      },
      "output": "excel_result"
    }
  ],
  "final_result": "âœ… Telemetry processing complete! Files saved:\nðŸ“„ CSV Report: {! csv_file_saved.metadata.file_path !}\nðŸ“Š Excel Report: {! excel_result.files_saved.saved_files[0] !}"
}